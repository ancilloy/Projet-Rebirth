<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" type="image/x-icon" href="ico.ico" />
    <title>Project Rebirth</title>
<!--JaajaScript-->
    <script>

    //Kaede Music
        function maestro() {
            var audio = document.getElementById("audio-player");
            if (audio.paused) {
                audio.play();
            } else {
                audio.pause();
            };
        }

    //Random Color
        let colormix = ""
        function randomColor() {
            let colormix = "#"+((1<<24)*Math.random()|0).toString(16)
            return colormix
        }

    //Counting Deaths
        function deadpeople() {
            let j = 0
            for (i = 0; i < 16; i++){
                if(document.getElementById("Live_"+i).checked == true){
                    j++
                }
            }
        //Results
            if (j == 0) {
                alert("À tous les étudiants. Aujourd'hui, personne n'est mort. Quel dommage.")
            }
            else if (j == 1) {
                alert ("À tous les étudiants. Aujourd'hui, une personne est morte. Quelle chance.")
            }
            else if (j == 6) {
                alert ("Au premier crépuscule, les six choisis par la clé seront sacrifiés.")
            }
            else {
                alert("À tous les étudiants. Aujourd'hui, " + j + " personnes sont mortes. Ou peut-être hier, je ne sais plus.")
            }
        }
        
    //Get data from .JSON
        async function fetchData() {
            try {
                const response = await fetch("https://ancilloy.github.io/Projet-Rebirth/dangandata.json");  //data on the git
                dangandata = await response.json();
                displayData(dangandata);
            } catch (error) {
                console.error('Oh no ! :', error);
            }
        }

    //Display data from .JSON
        function displayData(dangandata) {
            const dataList = document.getElementById('alpha');
            dataList.innerHTML = '';

            let row;
            dangandata.forEach((character, index) => {
            //Table Manager
                if (index % 4 === 0) {
                    row = document.createElement('tr');
                    dataList.appendChild(row);
                }
                const cell = document.createElement('td');

            //Import Image + Defines undraggable
                const danganImage = document.createElement('img');
                danganImage.src = character.url;
                danganImage.setAttribute('draggable', false);

            //Sprite Clicking Functions Manager
                danganImage.addEventListener('click', () => {
                    handleImageClick(character);
                });

            //Checkbox + ID
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';    
                checkbox.id = `Live_${index}`;
                
            //Cell Construction
                cell.appendChild(danganImage);
                cell.appendChild(document.createElement('br'));
                cell.appendChild(checkbox);
                row.appendChild(cell);
            });
        }

    //Sprite Clicking Functions
        function handleImageClick(character, index) {
            document.getElementById('dylanbob').textContent = "\"On vient pas de la street, nous ?\""

        //Himiko : Swaps background color
            if ((character.name) === "Himiko Yumeno") {
                document.body.style.backgroundColor = randomColor(colormix);
                document.getElementById('dylanbob').textContent = "\"Background color goes brrr\"";
            }

        //Kaede : Debussy (ça ressemble à Depussy, non ? Non...? Bon)
            if ((character.name) === "Kaede Akamatsu"){
                maestro();
                document.getElementById('dylanbob').textContent = "\"Je suis chanteur.\"";
            }

        //Tsumugi : Sends to Electrolithe
            if (character.name === "Tsumugi Shirogane") {
                document.getElementById('dylanbob').textContent = "\"Rip Tsumugi X Electrolithe\"";
            }

        //All : Swap left image + Name in log
            document.getElementById('danganleft').src = (character.url2);
            console.log('Vous avez cliqué sur : ' + (character.name));
            document.getElementById('bobdylan').textContent = "- " + (character.name);
        }

        document.addEventListener('DOMContentLoaded', fetchData);

    </script>
</head>
<body><h1 id="titre"><u>Project Rebirth</u></h1>
    <div class="container">
        <div class="block image-block">
    <!--Block 1-->
            <img id="danganleft" class="characterimage" alt="Clique sur un perso stp...">
        </div>
    <!--Block 2-->
        <div class="block table-block">
            <table class="DanganTable" id="alpha" onload="displayData"></table>
            <input type="submit" value="Valider les morts" onClick="deadpeople(); return false;"/>
            <a href=electrolithe.html><button>Grotte Electrolithe</button></a>
        <!--Kaede does who the fuck knows what-->
            <audio id="audio-player" src="Debussy - Clair de Lune.mp3" preload="auto"></audio>
        </div>
    <!--Block 3-->
        <div class="block empty-block">
            <h1 id="dylanbob">"On vient pas de la street, nous ?"</h1>
            <h2 id="bobdylan">- Nounours</h2>
        </div>
    </div>
    </div>
</body>
</html>


<!--Image floue pour Kokichi
Gérer les tailles de chaque blocs
- Miu trop grande
- Tableau central trop à l'étroit puis trop intrusif si trop zoomé

-->